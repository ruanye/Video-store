$('.start').on('click', function(event) {
    $('.page1').hide();
    $('.page2').show();
    event.preventDefault();
    /* Act on the event */
});
$('.lqbtn').on('click', function(event) {
    $('.page').hide();
    $('.page7').show();
    event.preventDefault();
    /* Act on the event */
});
$('.selectbtn span').on('click', function(event) {
    var that = $(this);
    if ($(this).attr('data-realy') == 'exist') {
        new TipBox({
            type: 'success',
            str: '恭喜你答对了',
            hasBtn: true,
            setTime: 14000,
            callBack: function() {
                that.parents('.page').hide().next().show();
            }
        });
    } else {
        new TipBox({
            type: 'error',
            str: '答错了，再试一次',
            hasBtn: true,
            setTime: 14000,

        });
    }
    event.preventDefault();
    /* Act on the event */
});
$('.save-btn').on('click', function(event) {
    Coupon.save();
    event.preventDefault();
    /* Act on the event */
});


var Coupon = {
        actId: null,
        //保存
        save: function() {

            var phoneNumber = $("#phoneNumber").val();
            if (phoneNumber.length == 0) {
                $("#errorInfo").html("<font color='red'>请填写手机号码</font>");
                return;
            }
            if (phoneNumber.length != 11) {
                $("#errorInfo").html("<font color='red'>请填写有效的手机号码</font>");
                return;
            }
            var reg = /^0?1[3|4|5|7|8][0-9]\d{8}$/;
            if (!reg.test(phoneNumber)) {
                $("#errorInfo").html("<font color='red'>请填写有效的手机号码</font>");
                return;
            }
            $('.btn').attr('disabled', 'disabled').html('获得中...');
            $.post('/morecoupon/save/' + Coupon.actId + "-" + phoneNumber, {
                israndom: 1
            }, function(data) {
                console.log(data);
                if (data.status == -1 || data.robstatus == 2 || data.robstatus == -1) {

                    //活动结束页面
                    $('.page').hide();
                    $(".end").show();
                } else {
                    //成功页面
                    if (data.robstatus == 1) {
                        //新用户抢码成功
                        $(".page12").show();


                        $('#register').on('click', function(event) {
                            event.preventDefault();
                            window.location.href = 'https://get.uber.com.cn/invite/ 冰淇淋宁波2016';

                        });
                    }
                    if (data.robstatus == 0) {
                    	$('.page').hide();
                        switch (data.money) {
                            case 105:
                               $('.page8').show();
                                break;
                            case 45:
                               $('.page9').show();
                                break;
                            case 30:
                                $('.page10').show();
                                break;
                            case 10:
                               $('.page11').show();
                                break;

                        }

                        return;
                    }
                }
            });
        }
    }
    $(document).ready(function() {
        var request = GetRequest();
        Coupon.actId = request['id'];
        if (Coupon.actId) {
            Event.sendEvent("counpon_" + Coupon.actId + parame);
        } else {
            //结束界面
            $("#page1").hide();
            $(".end").show();
        }
    });