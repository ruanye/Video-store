<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>优步伐刮刮乐(重庆)</title>
    <link href="css/index.css" rel="stylesheet" media="screen">
</head>

<body>
<!--<div style="position: absolute;margin:0 auto;display:none;"><img src="images/WeChat_1464079515.jpeg" alt=""></div>-->
<div class="wrap-page">
    <section class="page flex-m" id="page1">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner">
            <div class="gua-out-box">
                <div class="gua-logo"><img src="images/p-2.png" alt=""></div>
                <h4>刮出好彩头<span></span></h4>
                <div class="jbox-out-box" style="background:url(images/b-4.png) center center repeat;height: 3.786667rem;">
                </div>
            </div>
            <button class="com-btn" style="width:6.666667rem;margin-top:0.8rem;position:relative" onclick="$('#page1').hide();$('#page2').show();">点击刮奖 <img src="images/p-1.png" class="hand gua"></button>
        </div>
    </section>

    <section class="page flex-m" id="page2" style="display:none">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner">
            <div class="com-out-box">
                <img src="images/p-3.png" alt="" class="p-3">
                <p class="info-m" style="margin:0.533333rem auto">优步为您的隐私保驾护航</p>
                <input type="text" class="ipt" placeholder="请输入手机号码"/>
                <div style="margin-top:0.4rem">
                    <button class="com-btn1 x-flip" onclick="$('#page2').hide();$('#page3').show();loadPage();">立即领取红包</button>
                </div>
            </div>
        </div>
    </section>
    <section class="page flex-m" id="page3" style="display:none">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner">
            <div class="gua-out-box">
                <div class="gua-logo"><img src="images/p-2.png" alt=""></div>
                <h4>刮出好彩头<span></span></h4>
                <div class="jbox-out-box">
                    <div id="jbox">
                    </div>
                    <img src="images/b-4.png" alt="" id="b4" style="display:none">
                </div>
            </div>
            <button class="com-btn" style="width:6.666667rem;margin-top:0.8rem" id="freshBtn">点击右上角分享给好友</button>
        </div>
    </section>

    <!--新用户页面-->
    <section class="page flex-m" id="page4" style="display:none">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="top-box flex-1 flex-m">
            <div class="inner" style="margin-top:1rem;margin-bottom:1rem">
                <p class="info-m" style="color:#fff;">恭喜你抢到红包！</p>
                <img src="images/p-4.png" alt="" class="p-4">
                <p class="info-s1">优惠码将会在<span class="info-s2">5月28日(星期六)</span></p>
                <p class="info-s1">自动存入您的账户中，立即可用</p>
                <p class="info-s1 white-bg" style="margin-top:0.266667rem"><span>每人可享2程，每程最高减免7元</span></p>
                <div style="margin-top:0.533333rem">
                    <button class="com-btn1" style="font-size:0.48rem">立即注册领取乘车优惠券</button>
                </div>
            </div>
        </div>
        <div class="bottom-box">
            <div class="inner">
                <div>
                    <span class="info-s1">新用户输入优惠码</span>
                    <label class="yh-code-box">
                        <input type="text" value="" class="yh-code"/>
                    </label>
                </div>
                <p class="info-s2" style="margin-top:0.3rem">即可获得2程10元乘车机会</p>
            </div>
        </div>
    </section>

    <!--老用户页面-->
    <section class="page flex-m" id="page5" style="display:none">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner" style="margin-top:1rem;margin-bottom:1rem">
            <p class="info-m" style="color:#fff;">恭喜你抢到红包！</p>
            <img src="images/p-4.png" alt="" class="p-4">
            <p class="info-s1">优惠码将会在<span class="info-s2">5月28日(星期六)</span></p>
            <p class="info-s1">自动存入您的账户中，立即可用</p>
            <p class="info-s1 white-bg" style="margin-top:0.266667rem"><span>每人可享2程，每程最高减免7元</span></p>
            <div style="margin-top:0.533333rem">
                <button class="com-btn1" style="font-size:0.48rem" >一键获得30元</button>
            </div>
            <div style="margin-top:0.533333rem">
                <button class="com-btn1" style="font-size:0.48rem" onclick="$('#page5').hide();$('#page6').show();">点击右上角分享给好友</button>
            </div>
        </div>
    </section>

    <!--分享页面-->
    <section class="page" id="page6" style="display:none">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner">
            <img src="images/p-6.png" alt="" style="width:100%;">
            <div style="margin-top:0.533333rem">
                <span class="info-s1">新用户输入优惠码</span>
                <label class="yh-code-box">
                    <input type="text" value="" class="yh-code"/>
                </label>
            </div>
            <p class="info-s2" style="margin-top:0.3rem;margin-bottom:0.3rem">即可获得2程10元乘车机会</p>
        </div>
    </section>
    </section>

    <!--活动结束 页面-->
    <section class="page flex-m" id="page7" style="display:none;">
        <img src="images/logo.png" alt="" class="fixed-logo">
        <div class="inner">
            <img src="images/p-7.png" alt="" class="p-7">
        </div>
    </section>

    <!--分享页-->
    <section class="page mask" id="page8" onclick="$('#page8').hide();" style="z-index:999;display: none;">
        <img src="images/p-8.png" alt="" style="width:4.133333rem;position:fixed;top:0;right:0;">
    </section>
</div>
<script src="vendor/lib-flexible/build/flexible.js"></script>
<script src="vendor/zepto/zepto.min.js"></script>
<script src="js/scratch.js"></script>
<script>
    function loadPage() {
        var jbox = document.getElementById('jbox');
        var w = jbox.offsetWidth;
        var h = jbox.offsetHeight;
        var text = getRandomStr(10);
        var lottery = new Lottery('jbox', 'images/b-4.png', 'image', w, h, drawPercent);
        lottery.init(text, 'text');


        document.getElementById('freshBtn').onclick = function () {
            // drawPercentNode.innerHTML = '0%';
//            text = getRandomStr(10);
//            lottery.init(text, 'text');
            $("#page8").show();
        }

        // var drawPercentNode = document.getElementById('drawPercent');

        function drawPercent(percent) {
            // drawPercentNode.innerHTML = percent + '%';
            if (percent > 10) {
                if(text.indexOf('恭喜您') != -1){
                    document.getElementById('freshBtn').innerHTML="立即领取红包";
                    document.getElementById('freshBtn').onclick = function(){
                        window.localStorage.setItem("",1);
                        $("#page3").hide();
                        $("#page5").show();
                    };
                }else{
                    document.getElementById('freshBtn').innerHTML="再刮一次";
                    document.getElementById('freshBtn').onclick = function(){
                        text = getRandomStr(10);
                        lottery.init(text, 'text');
                    };
                }
            }
        }
    }
    function getRandomStr(len) {
        var text = "";
        //如果需要上下并排显示就在内容需要换行的地方添加:'—'
        var possible = ['恭喜您!!!-刮出红包一个', '再接再厉-你还有一次机会'];
        //var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        //for( var i=0; i < len; i++ )
        //text += possible.charAt(Math.floor(Math.random() * possible.length));
        text = possible[Math.floor(Math.random() * possible.length)];
        return text;
    }
</script>
</body>

</html>
